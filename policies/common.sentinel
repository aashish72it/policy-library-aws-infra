import "tfplan/v2" as tfplan

# Return planned resources of a given type (create or update)
get_resources = func(type) {
  tfplan.resource_changes[type].filter(rc) {
    rc.mode is "managed" and
    (rc.change.actions contains "create" or rc.change.actions contains "update")
  }
}

# Simple tag fetcher from "after" object
get_tags = func(after) {
  if after.tags is undefined { return {} }
  else { return after.tags }
}