import "tfplan/v2" as tfplan
import "common"

# Customize the allowlist here
allowed = [
  "t3.micro", "t3.small", "t3.medium",
  "t4g.micro", "t4g.small", "t4g.medium"
]

instances = common.get_resources("aws_instance")

main = rule {
  all instances as i {
    after = i.change.after
    allowed contains after.instance_type
  }
}